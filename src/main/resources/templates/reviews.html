<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Reviews Page</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>

<h1>Reviews</h1>

<div id="reviews-container">
</div>

<div id="pagination">
</div>

<script>
    let currentPage = 0;
    const pageSize = 10;

    const loadReviews = (page) => {
        $.ajax({
            url: `/api/reviews?page=${page}&size=${pageSize}`,
            method: 'GET',
            dataType: 'json',
            success: function (data) {
                displayReviews(data.content);
                displayPagination(data.totalPages, page);
            },
            error: function (error) {
                console.error('Error loading reviews:', error);
            }
        });
    };

    const displayReviews = (reviews) => {
        const container = $('#reviews-container');
        container.empty(); // Clear previous reviews

        reviews.forEach(review => {
            const reviewHtml = `
                <div class="review">
                    <h3>${review.firstName} ${review.lastName}</h3>
                    <p>Rating: ${review.rating}</p>
                    <p>${review.content}</p>
                    <p>Created At: ${new Date(review.createdAt).toLocaleString()}</p>
                </div>
            `;
            container.append(reviewHtml);
        });
    };

    const displayPagination = (totalPages, currentPage) => {
        const pagination = $('#pagination');
        pagination.empty();

        for (let i = 0; i < totalPages; i++) {
            const button = `
                <button onclick="loadReviews(${i})" ${i === currentPage ? 'disabled' : ''}>${i + 1}</button>
            `;
            pagination.append(button);
        }
    };

    // Initial load of reviews
    loadReviews(currentPage);
</script>

<style>
    #reviews-container {
        margin-bottom: 20px;
    }

    .review {
        border: 1px solid #ccc;
        padding: 10px;
        margin-bottom: 10px;
    }

    #pagination button {
        margin-right: 5px;
    }

    #pagination button[disabled] {
        background-color: #ccc;
        cursor: not-allowed;
    }
</style>

</body>
</html>
